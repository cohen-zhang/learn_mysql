# 报错及定位

## 定位

1. 查数据库的 error 日志

## 常见报错

1. 数据库访问重试警告



## 如果 MySQL 主从数据库同步关闭之后，在主库上测试发现磁盘空间被打爆了，可以有以下原因：

1. 未关闭二进制日志

在 MySQL 中，启用 binary log 功能会将所有修改数据库的操作记录到一个 binlog 文件中，以便在进行主从数据库同步时使用。如果在关闭主从同步后没有关闭二进制日志，可能会导致 binlog 文件不断增大，最终占满磁盘空间。因此，需要在关闭主从同步之后及时关闭二进制日志的功能。

2. 慢查询日志过多

MySQL 中的慢查询日志可以记录查询执行时间超过一定阈值的 SQL 语句。如果在关闭主从同步后仍然持续使用了慢查询日志功能，可能会导致日志文件不断增大，最终占满磁盘空间。

3. 系统日志过多

在某些情况下，系统日志（如 /var/log/messages 或 /var/log/syslog）可能会记录 MySQL 数据库的输出信息。如果在关闭主从同步后仍然持续记录这些信息，可能会导致日志文件不断增大，最终占满磁盘空间。

针对以上问题，可以根据具体情况进行相应的处理，如关闭二进制日志、清除或压缩日志文件等操作，并定期检查磁盘空间使用情况，避免数据库因磁盘空间不足而出现问题。同时也可以通过设置 MySQL 的日志轮换参数或者利用系统的日志轮换工具来自动清理过于庞大的日志文件，防止磁盘空间占满的问题发生。

用户密码是：780309 在 Linux 上加密后的密文是：NzgwMzA5，加密规则是：md5(sha1(密码明文))。


## 一个JDBC事务回滚失败的问题：

"Could not roll back JDBC transaction; nested exception is java.sql.SQLException: Connection has already been closed"

可能的原因是：

- 数据库连接已经被关闭，但代码仍在尝试进行事务回滚操作
- 在事务执行过程中连接意外断开或超时
- 连接池配置问题导致连接过早被回收

建议检查：

- 确保事务中不会提前关闭数据库连接
- 检查数据库连接池的配置，特别是连接超时时间设置
- 查看是否有异常处理逻辑导致连接提前关闭